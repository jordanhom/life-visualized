<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Your Life Visualized</title>
    <!-- Link to the external CSS file -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Main content container, centered with max-width -->
    <div class="container">
        <h1>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 0.5em; vertical-align: -0.2em; position: relative; top: -1px;">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>Visualize Your Life
        </h1>

        <!-- Container for the introductory text block -->
        <div class="intro-block-container">
            <p class="intro-text">Explore your timeline. Reflect on your journey.</p>
            <p class="intro-disclaimer"><strong>Important:</strong> For reflection only. Not a lifespan predictor.</p>
        </div>
        
        <!-- Input Form Section -->
        <form id="life-input-form" class="input-form">
            <div class="form-group">
                <label for="birthdate">Your Birth Date:</label>
                <p class="label-supplement">Starting point for age and timeline.</p>
                <input type="date" id="birthdate" name="birthdate" required placeholder="YYYY-MM-DD">
            </div>

            <div class="form-group">
                <label for="sex">Biological Sex:</label>
                <p class="label-supplement">Input for statistical timeline estimate.</p>
                <select id="sex" name="sex" required placeholder="Select...">
                    <option value="" disabled selected>Select...</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                </select>
            </div>

            <button type="submit" class="calculate-btn" id="calculate-btn" title="Please fill in both fields." disabled>Calculate & Visualize</button>
        </form>

        <!-- Results Display Area -->
        <!-- Initially hidden. Revealed by JS to show calculation results or errors. -->
        <!-- aria-live="polite" ensures screen readers announce updates -->
        <div id="results-area" class="results-area hidden" aria-live="polite">
            <!-- Content (results or errors) is dynamically updated by ui.js -->
        </div>

        <!-- Grid Placeholder -->
        <!-- Initially hidden. Revealed by JS after successful calculation. -->
        <!-- This container is populated with the grid by gridRenderer.js -->
        <!-- aria-label provides context for screen readers -->
        <div id="life-grid-container" class="life-grid-container hidden" aria-label="Life grid visualization">

            <!-- MOVED Grid Controls Header INSIDE grid container -->
            <div id="grid-controls-header" class="hidden"> <!-- Removed grid-width-constraint as it's inside now -->
                <!-- Note: h4 title removed -->
                <div id="view-switcher" role="radiogroup" aria-labelledby="view-switcher-label">
                     <span id="view-switcher-label" class="visually-hidden">Select grid view</span>
                     <button role="radio" aria-checked="true" data-view="weeks-age" class="view-button active" title="View life in weeks by age">Weeks (Age)</button>
                     <button role="radio" aria-checked="false" data-view="weeks-calendar" class="view-button" title="View life in weeks by calendar year">Weeks (Calendar)</button>
                     <button role="radio" aria-checked="false" data-view="months" class="view-button" title="View life in months">Months</button>
                     <button role="radio" aria-checked="false" data-view="years" class="view-button" title="View life in years">Years</button>
                </div>
            </div>

            <!-- MOVED Grid Guide Details INSIDE grid container, AFTER controls -->
            <details id="grid-guide-details" class="grid-guide-details hidden">
                <summary>How to Read This Visualization</summary>
                <div class="guide-content-wrapper">
                    <div class="explanation-column">
                        <h3>Understanding the Grid</h3>
                        <p>Each block represents a unit of time in your estimated lifespan. Colors indicate the general life stage for that period. Blocks fade for time already passed, and the current block is highlighted.</p>
                        <ul>
                            <li><strong>Weeks (by Age):</strong> Each row is one year of life (up to 53 weeks). Weeks align with your age progression.</li>
                            <li><strong>Weeks (by Calendar):</strong> Each row represents a full calendar year. To maintain alignment with the calendar, you might see uncolored blocks at the start or end if your estimated lifespan only covers part of that calendar year. These blocks complete the standard year structure.</li>
                            <li><strong>Months:</strong> Each row is one year of life (12 months).</li>
                            <li><strong>Years:</strong> Each row is one decade (10 years).</li>
                        </ul>
                        <!-- Reminder: A small visual diagram here would still significantly boost comprehension for View B. -->                    <div class="color-key-column">
                        <h3>What the Colors Mean</h3>
                        <div class="color-key"> <!-- Re-use existing color-key class for list styling -->
                            <ul>
                                <li><span class="key-color stage-infancy"></span> Infancy (0-1)</li>
                                <li><span class="key-color stage-toddler"></span> Toddler (1-3)</li>
                                <li><span class="key-color stage-earlychildhood"></span> Early Childhood (3-6)</li>
                                <li><span class="key-color stage-middlechildhood"></span> Middle Childhood (6-11)</li>
                                <li><span class="key-color stage-adolescence"></span> Adolescence (11-18)</li>
                                <li><span class="key-color stage-youngadult"></span> Young Adult (18-25)</li>
                                <li><span class="key-color stage-adulthood"></span> Adulthood (25-40)</li>
                                <li><span class="key-color stage-middleadulthood"></span> Middle Adulthood (40-65)</li>
                                <li><span class="key-color stage-earlysenior"></span> Early Senior (65-75)</li>
                                <li><span class="key-color stage-midsenior"></span> Mid Senior (75-85)</li>
                                <li><span class="key-color stage-latesenior"></span> Late Senior (85+)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </details>

            <!-- This div will specifically hold the grid blocks generated by gridRenderer -->
            <div id="grid-content-area"></div>

            <!-- Grid blocks generated by gridRenderer.js go inside #grid-content-area -->
        </div>

        <!-- "Start Over" Button, initially hidden - MOVED HERE -->
        <button id="start-over-btn" class="calculate-btn hidden" style="margin-top: var(--space-lg); margin-bottom: var(--space-lg);">Start Over</button>

        <!-- Disclaimer Section -->
        <!-- Always visible. -->
        <p class="disclaimer">
            <strong>Disclaimer:</strong> Life expectancy figures are estimates based on statistical averages for populations (using U.S. CDC/NCHS 2021 Period Life Table data) and may vary based on location, lifestyle, genetics, and future advancements. This visualization is for illustrative purposes only and is <strong>not</strong> a prediction of your individual lifespan.
        </p>

    </div> <!-- End .container -->

    <!-- External Libraries -->
    <!-- date-fns v4.1.0 is required by gridRenderer.js and ui.js -->
    <script src="https://cdn.jsdelivr.net/npm/date-fns@4.1.0/cdn.min.js"></script>

    <!-- Main Application Script -->
    <!-- Loaded as a module to enable import/export syntax -->
    <script type="module" src="js/main.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Your Life Visualized</title>
    <!-- Link to the external CSS file -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Main content container, centered with max-width -->
    <div class="container">
        <h1>Visualize Your Life</h1>
        <!-- Introductory text displayed on initial load -->
        <p class="intro-text">See your estimated lifespan visualized. Enter your details below to begin.</p>

        <!-- Input Form Section -->
        <form id="life-input-form" class="input-form">
            <div class="form-group">
                <label for="birthdate">Your Birth Date:</label>
                <input type="date" id="birthdate" name="birthdate" required>
            </div>

            <div class="form-group">
                <label for="sex">Sex (for actuarial estimate):</label>
                <select id="sex" name="sex" required>
                    <option value="" disabled selected>-- Select --</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <!-- Add other options if your data source supports them -->
                </select>
            </div>

            <button type="submit" class="calculate-btn" id="calculate-btn">Calculate & Visualize</button>
        </form>

        <!-- Results Heading -->
        <!-- Initially hidden. Revealed by JS with results/errors. -->
        <h2 id="results-heading" class="section-heading hidden">Results</h2>

        <!-- Results Display Area -->
        <!-- Initially hidden. Revealed by JS to show calculation results or errors. -->
        <!-- aria-live="polite" ensures screen readers announce updates -->
        <div id="results-area" class="results-area hidden" aria-live="polite">
            <!-- Content (results or errors) is dynamically updated by ui.js -->
        </div>

        <!-- Visualization Heading -->
        <!-- MOVED HERE - Before Grid -->
        <!-- Initially hidden. Revealed by JS with the grid after successful calculation. -->
        <h2 id="visualization-heading" class="section-heading hidden">Visualization</h2>

        <!-- Grid Placeholder -->
        <!-- MOVED HERE - After Results/Visualization Heading for prominence -->
        <!-- Initially hidden. Revealed by JS after successful calculation. -->
        <!-- This container is populated with the grid by gridRenderer.js -->
        <!-- aria-label provides context for screen readers -->
        <div id="life-grid-container" class="life-grid-container hidden" aria-label="Life grid visualization">
            <!-- The life grid will be generated here by JavaScript -->
        </div>

        <!-- View Toggle Controls -->
        <!-- Initially hidden. Revealed by JS after successful calculation. -->
        <!-- Radio buttons to select the grid visualization type -->
        <fieldset class="view-toggle hidden">
            <legend>Grid View Type:</legend>
            <div>
                <input type="radio" id="view-age" name="viewType" value="age" checked>
                <label for="view-age">Weeks (by Age)</label>
            </div>
            <div>
                <input type="radio" id="view-calendar" name="viewType" value="calendar">
                <label for="view-calendar">Weeks (by Calendar)</label>
            </div>
            <div>
                <input type="radio" id="view-months" name="viewType" value="months">
                <label for="view-months">Months</label>
            </div>
            <div>
                <input type="radio" id="view-years" name="viewType" value="years">
                <label for="view-years">Years (Decades)</label>
            </div>
        </fieldset>

        <!-- Explanation Section (Expandable) -->
        <!-- Initially hidden. Revealed by JS after successful calculation. -->
        <!-- Provides context about reading the different grid views. -->
        <details id="explanation" class="explanation-details hidden">
            <summary>How to Read This Visualization</summary>
            <p>Each block represents a unit of time in your estimated lifespan. Colors indicate the general life stage for that period. Blocks fade for time already passed, and the current block is highlighted.</p>
            <ul>
                <li><strong>Weeks (by Age):</strong> Each row is one year of life (up to 53 weeks). Weeks align with your age progression.</li>
                <li><strong>Weeks (by Calendar):</strong> Each row is a calendar year. Weeks align with standard ISO calendar weeks. Some blocks may appear 'out of bounds' if your lifespan doesn't perfectly align with calendar year starts/ends.</li>
                <li><strong>Months:</strong> Each row is one year of life (12 months).</li>
                <li><strong>Years:</strong> Each row is one decade (10 years).</li>
            </ul>
        </details>

        <!-- Color Key Section (Expandable) -->
        <!-- Initially hidden. Revealed by JS after successful calculation. -->
        <!-- Displays the mapping of colors to life stages. -->
        <details id="color-key-details" class="color-key-details hidden">
            <summary>Color Key (Life Stages)</summary>
            <!-- Inner div contains the actual key list -->
            <div class="color-key">
                <ul>
                    <li><span class="key-color stage-infancy"></span> Infancy (0-1)</li>
                    <li><span class="key-color stage-toddler"></span> Toddler (1-3)</li>
                    <li><span class="key-color stage-earlychildhood"></span> Early Childhood (3-6)</li>
                    <li><span class="key-color stage-middlechildhood"></span> Middle Childhood (6-11)</li>
                    <li><span class="key-color stage-adolescence"></span> Adolescence (11-18)</li>
                    <li><span class="key-color stage-youngadult"></span> Young Adult (18-25)</li>
                    <li><span class="key-color stage-adulthood"></span> Adulthood (25-40)</li>
                    <li><span class="key-color stage-middleadulthood"></span> Middle Adulthood (40-65)</li>
                    <li><span class="key-color stage-earlysenior"></span> Early Senior (65-75)</li>
                    <li><span class="key-color stage-midsenior"></span> Mid Senior (75-85)</li>
                    <li><span class="key-color stage-latesenior"></span> Late Senior (85+)</li>
                </ul>
            </div>
        </details>

        <!-- Disclaimer Section -->
        <!-- Always visible. -->
        <p class="disclaimer">
            <strong>Disclaimer:</strong> Life expectancy figures are estimates based on statistical averages for populations (using U.S. CDC/NCHS 2021 Period Life Table data) and may vary based on location, lifestyle, genetics, and future advancements. This visualization is for illustrative purposes only and is <strong>not</strong> a prediction of your individual lifespan.
        </p>

    </div> <!-- End .container -->

    <!-- External Libraries -->
    <!-- date-fns v4.1.0 is required by gridRenderer.js and ui.js -->
    <script src="https://cdn.jsdelivr.net/npm/date-fns@4.1.0/cdn.min.js"></script>

    <!-- Main Application Script -->
    <!-- Loaded as a module to enable import/export syntax -->
    <script type="module" src="js/main.js"></script>
</body>
</html>
